################
### MONITORS ###
################

monitor = eDP-1, 2560x1600@244, 0x0, 1.6
monitor = desc:Philips Consumer Electronics Company PHL 246E9Q 0x000048F1, 1920x1080@75, 1600x0, 1
monitor = desc:Dell Inc. DELL P2422H 1F4BTY3, 1920x1080@75, 3520x0, 1

###################
### MY PROGRAMS ###
###################

$terminal = ghostty
$fileManager = nautilus
$menu = vicinae toggle

#################
### AUTOSTART ###
#################

env = GTK_IM_MODULE,fcitx
env = QT_IM_MODULE,fcitx
env = XMODIFIERS,@im=fcitx

exec-once = swaybg -i ~/current-bg.jpg
exec-once = vicinae server 
exec-once = hypridle
exec-once = echo "0" > ~/.ashell.lock
exec-once = /opt/1Password/1password --ozone-platform-hint=x11 --silent %U
exec-once = hyprctl plugin load /home/simon/tools/hyprland-plugins/hyprfocus/hyprfocus.so
exec-once = blinkdisk --hidden %U
exec-once = bash -lc 'eval $(/usr/bin/gnome-keyring-daemon --start --components=ssh,secrets)'
exec-once = fcitx5 -d --replace

#############################
### ENVIRONMENT VARIABLES ###
#############################

env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24
env = LIBVA_DRIVER_NAME,nvidia
env = __GLX_VENDOR_LIBRARY_NAME,nvidia
env = ELECTRON_OZONE_PLATFORM_HINT,auto

# card 1 = AMD
# card 2 = Nvidia
env = AQ_DRM_DEVICES,/dev/dri/card1:/dev/dri/card2
env = AQ_NO_ATOMIC,1
# env = AQ_NO_MODIFIERS,1

# Fix for steam
env = QT_QPA_PLATFORM,wayland

#####################
### LOOK AND FEEL ###
#####################

general {
    gaps_in = 5
    gaps_out = 5

    border_size = 2

    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)

    resize_on_border = false
    allow_tearing = false

    layout = dwindle
}

decoration {
    rounding = 4

    # Change transparency of focused and unfocused windows
    active_opacity = 1.0
    inactive_opacity = 0.9

    shadow {
        enabled = true
        range = 4
        render_power = 3
        color = rgba(1a1a1aee)
    }

    blur {
        enabled = true
        size = 3
        passes = 1

        vibrancy = 0.1696
    }
}

animations {
    enabled = yes, please :)

    bezier = easeOutQuint,0.23,1,0.32,1
    bezier = easeInOutCubic,0.65,0.05,0.36,1
    bezier = linear,0,0,1,1
    bezier = almostLinear,0.5,0.5,0.75,1.0
    bezier = quick,0.15,0,0.1,1

    animation = global, 1, 10, default
    animation = border, 1, 5.39, easeOutQuint
    animation = windows, 1, 4.79, easeOutQuint
    animation = windowsIn, 1, 4.1, easeOutQuint, popin 87%
    animation = windowsOut, 1, 1.49, linear, popin 87%
    animation = fadeIn, 1, 1.73, almostLinear
    animation = fadeOut, 1, 1.46, almostLinear
    animation = fade, 1, 3.03, quick
    animation = layers, 1, 3.81, easeOutQuint
    animation = layersIn, 1, 4, easeOutQuint, fade
    animation = layersOut, 1, 1.5, linear, fade
    animation = fadeLayersIn, 1, 1.79, almostLinear
    animation = fadeLayersOut, 1, 1.39, almostLinear
    animation = workspaces, 1, 1.94, almostLinear, slidefadevert
    animation = workspacesIn, 1, 1.21, almostLinear, slidefadevert
    animation = workspacesOut, 1, 1.94, almostLinear, slidefadevert
    animation = hyprfocusIn, 1, 1.4, almostLinear 
    animation = hyprfocusOut, 1, 1.4, almostLinear
}

plugin {
    hyprfocus {
        mode = flash 
        fade_opacity = 0.8
    }
}

workspace = 1, monitor:eDP-1, default:true
workspace = 2, monitor:desc:Philips Consumer Electronics Company PHL 246E9Q 0x000048F1, default:true
workspace = 3, monitor:desc:Dell Inc. DELL P2422H 1F4BTY3, default:true
workspace = 4, monitor:eDP-1
workspace = 5, monitor:desc:Philips Consumer Electronics Company PHL 246E9Q 0x000048F1
workspace = 6, monitor:desc:Dell Inc. DELL P2422H 1F4BTY3
workspace = 7, monitor:eDP-1
workspace = 8, monitor:desc:Philips Consumer Electronics Company PHL 246E9Q 0x000048F1
workspace = 9, monitor:desc:Dell Inc. DELL P2422H 1F4BTY3
workspace = 10, monitor:eDP-1
workspace = 11, monitor:desc:Philips Consumer Electronics Company PHL 246E9Q 0x000048F1
workspace = 12, monitor:desc:Dell Inc. DELL P2422H 1F4BTY3

workspace=f[0],rounding=false,bordersize:0,gapsout:0
workspace=f[1],rounding=false,bordersize:0,gapsout:0

bind = SUPER CTRL, j, workspace, +3
bind = SUPER CTRL, k, workspace, -3

bind = SUPER, Space, exec, sh -c '[ "$(cat ~/.ashell.lock 2>/dev/null || echo 0)" = "1" ] && { pkill -x ashell >/dev/null 2>&1; echo 0 > ~/.ashell.lock; } || { ashell >/dev/null 2>&1 & echo 1 > ~/.ashell.lock; }'

dwindle {
    pseudotile = true # Master switch for pseudotiling. Enabling is bound to mainMod + P in the keybinds section below
    preserve_split = true # You probably want this
}

master {
    new_status = master
}

misc {
    force_default_wallpaper = 0
    disable_hyprland_logo = true
}


#############
### INPUT ###
#############

input {
    kb_layout = de
    kb_variant = 
    kb_model =
    kb_options =
    kb_rules =

    follow_mouse = 2
    accel_profile = flat

    sensitivity = 0

    touchpad {
        natural_scroll = true
        disable_while_typing = yes
    }
}

device {
    name = asup1207:00-093a:3012-touchpad
    sensitivity = 0.2
}

gesture = 3, horizontal, workspace
gesture = 2, pinch, scale: 1.5, fullscreen

cursor {
   no_hardware_cursors = true
}

###################
### KEYBINDINGS ###
###################

$mainMod = SUPER # Sets "Windows" key as main modifier

bind = $mainMod, down, exec, \
id=$(hyprctl activeworkspace -j | jq '.id'); \
group=$(( (id + 2) / 3 )); \
(( group >= 4 )) && exit; \
hyprctl dispatch workspace $((group*3+1)); \
hyprctl dispatch workspace $((group*3+2)); \
hyprctl dispatch workspace $((group*3+3));

bind = $mainMod, up, exec, \
id=$(hyprctl activeworkspace -j | jq '.id'); \
group=$(( (id + 2) / 3 )); \
(( group <= 1 )) && exit; \
hyprctl dispatch workspace $((group*3-5)); \
hyprctl dispatch workspace $((group*3-4)); \
hyprctl dispatch workspace $((group*3-3));


bind = $mainMod, T, exec, $terminal
bind = $mainMod, C, killactive,
bind = $mainMod, E, exec, $fileManager
bind = $mainMod, V, togglefloating,
bind = $mainMod, R, exec, $menu
# bind = $mainMod, P, pseudo,
bind = $mainMod, S, togglesplit, # dwindle
bind = $mainMod, F, fullscreen, 1

# Move focus with mainMod + arrow keys
bind = $mainMod, h, movefocus, l
bind = $mainMod, l, movefocus, r
bind = $mainMod, k, movefocus, u
bind = $mainMod, j, movefocus, d

# Move active window to a workspace with mainMod + SHIFT + [0-9]
bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6
bind = $mainMod SHIFT, 7, movetoworkspace, 7
bind = $mainMod SHIFT, 8, movetoworkspace, 8
bind = $mainMod SHIFT, 9, movetoworkspace, 9
bind = $mainMod SHIFT, 0, movetoworkspace, 10

#
# CUSTOM SHORTCUTS
#
bind = CTRL SHIFT, Space, exec, 1password --quick-access
bind = $mainMod ALT, 1, exec, pactl set-default-sink alsa_output.pci-0000_65_00.1.hdmi-stereo
bind = $mainMod ALT, 2, exec, pactl set-default-sink alsa_output.usb-Creative_Technology_Ltd_Creative_Stage_Air_V2_Creative_Lab-01.analog-stereo
bind = $mainMod ALT, 3, exec, pactl set-default-sink alsa_output.pci-0000_65_00.6.analog-stereo

bind = $mainMod, I, focusmonitor, 1
bind = $mainMod, U, focusmonitor, 0
bind = $mainMod, O, focusmonitor, 2

# Example special workspace (scratchpad)
bind = $mainMod, m, togglespecialworkspace, music 
bind = $mainMod, n, togglespecialworkspace, gather
bind = $mainMod SHIFT, m, movetoworkspace, special:music
bind = $mainMod SHIFT, n, movetoworkspace, special:gather

# Scroll through existing workspaces with mainMod + scroll
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1

# Print screen to clipboard and save
bind = , Print, exec, bash -c 'mkdir -p ~/Pictures/Screenshots && grim -g "$(slurp -d)" - | tee >(wl-copy) > ~/Pictures/Screenshots/$(date +'%Y-%m-%d_%H-%M-%S').png'

# Move/resize windows with mainMod + LMB/RMB and dragging
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Laptop multimedia keys for volume and LCD brightness
bindel = ,XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
bindel = ,XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindel = ,XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindel = ,XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bindel = ,XF86MonBrightnessUp, exec, brightnessctl s 10%+
bindel = ,XF86MonBrightnessDown, exec, brightnessctl s 10%-

# Requires playerctl
bindl = , XF86AudioNext, exec, playerctl next
bindl = , XF86AudioPause, exec, playerctl play-pause
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPrev, exec, playerctl previous

##############################
### WINDOWS AND WORKSPACES ###
##############################

# Ignore maximize requests from apps. You'll probably like this.
windowrule = suppressevent maximize, class:.*

# Fix some dragging issues with XWayland
windowrule = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

windowrule = float,class:xdg-desktop-portal-gtk

# Disable effects for albert run window
windowrule = noblur, class:albert
windowrule = noborder, class:albert
windowrule = noshadow, class:albert

windowrule = workspace special:music, class:(chrome-cinhimbnkkaeohfgghhklpknlkffjgod-Profile_2)
windowrule = workspace special:gather, class:(chrome-odhdeommofkpfnffhlpjhbeiedldfelj-Profile_1)
